<div class="upload-container">
  <div class="upload-header">
    <h3>Upload de Fotos e V√≠deos</h3>
    <p>Selecione arquivos de imagem (JPEG, PNG, GIF) ou v√≠deo (MP4, AVI, MOV)</p>
  </div>

  <!-- √Årea de drop de arquivos -->
  <div
    class="drop-zone"
    (drop)="onFileDrop($event)"
    (dragover)="onDragOver($event)"
    (dragleave)="onDragLeave($event)"
    [class.drag-over]="isDragOver"
  >
    <div class="drop-content">
      <i class="upload-icon">üìÅ</i>
      <h4>Arraste os arquivos aqui</h4>
      <p>ou</p>
      <input
        type="file"
        #fileInput
        (change)="onFileSelected($event)"
        multiple
        accept="image/*,video/*"
        class="file-input"
      />
      <button
        type="button"
        class="btn btn-primary"
        (click)="fileInput.click()"
      >
        Selecione os Arquivos
      </button>
    </div>
  </div>

  <!-- Lista de arquivos selecionados -->
  <div class="files-list" *ngIf="selectedFiles.size > 0">
    <div class="files-header">
      <h4>Arquivos Selecionados ({{ selectedFiles.size }})</h4>
      <button
        type="button"
        class="btn btn-danger btn-sm"
        (click)="clearAllFiles()"
        [disabled]="isUploading"
      >
        Remover Todos
      </button>
    </div>

<div class="files-grid">
  <!-- Use *ngFor com entries do Map -->
  <div
    *ngFor="let file of selectedFiles | keyvalue"
    class="file-item"
    [class.uploading]="file.value.uploading"
    [class.error]="file.value.error"
  >
    <div class="file-icon">
      {{ getFileIcon(file.value.type) }}
    </div>

    <div class="file-info">
      <div class="file-name" [title]="file.value.name">
        {{ file.value.name }}
      </div>
      <div class="file-details">
        {{ formatFileSize(file.value.size) }} ‚Ä¢ {{ file.value.type || 'Tipo desconhecido' }}
      </div>
      <div class="file-status" *ngIf="file.value.uploading || file.value.error || file.value.progress !== undefined">
        <div *ngIf="file.value.uploading" class="progress-container">
          <div class="progress-bar">
            <div
              class="progress-fill"
              [style.width.%]="file.value.progress || 0"
            ></div>
          </div>
          <span class="progress-text">{{ file.value.progress || 0 }}%</span>
        </div>
        <div *ngIf="file.value.error" class="error-message">
          ‚ùå {{ file.value.error }}
        </div>
        <div *ngIf="file.value.completed" class="success-message">
          ‚úÖ Conclu√≠do
        </div>
      </div>
    </div>

    <div class="file-actions">
      <button
        type="button"
        class="btn-remove"
        (click)="removeFile(file.key)"
        [disabled]="file.value.uploading"
        title="Remover arquivo"
      >
        ‚úï
      </button>
    </div>
  </div>
</div>

    <!-- Bot√£o de upload -->
    <div class="upload-actions">
      <button
        type="button"
        class="btn btn-success btn-upload"
        (click)="uploadFiles()"
        [disabled]="selectedFiles.size === 0 || isUploading"
      >
        <span *ngIf="!isUploading">üì§ Enviar {{ selectedFiles.size }} Arquivo(s)</span>
        <span *ngIf="isUploading">
          <div class="loading-spinner"></div>
          Enviando... ({{ getUploadingCount() }}/{{ selectedFiles.size }})
        </span>
      </button>
    </div>
  </div>
</div>
